{"cells":[{"cell_type":"code","execution_count":1,"metadata":{"executionInfo":{"elapsed":13,"status":"ok","timestamp":1663664424342,"user":{"displayName":"19EC032 Hari haran R","userId":"00578135646265226488"},"user_tz":-330},"id":"5VK-8NvZPemS"},"outputs":[],"source":["import os\n","import shutil\n","import  random"]},{"cell_type":"code","source":[],"metadata":{"id":"tritMqD2NBWn"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":2,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":91171,"status":"ok","timestamp":1663664515502,"user":{"displayName":"19EC032 Hari haran R","userId":"00578135646265226488"},"user_tz":-330},"id":"_PbgsvAkWDhG","outputId":"5258db37-cfd4-4ccf-c308-6398d016ec1e"},"outputs":[{"output_type":"stream","name":"stdout","text":["Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(\"/content/drive\", force_remount=True).\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"code","execution_count":2,"metadata":{"executionInfo":{"elapsed":27,"status":"ok","timestamp":1663664515503,"user":{"displayName":"19EC032 Hari haran R","userId":"00578135646265226488"},"user_tz":-330},"id":"ZhxkEK6SXX9I"},"outputs":[],"source":[]},{"cell_type":"code","execution_count":3,"metadata":{"executionInfo":{"elapsed":21,"status":"ok","timestamp":1663664515504,"user":{"displayName":"19EC032 Hari haran R","userId":"00578135646265226488"},"user_tz":-330},"id":"GWzoSRsCTHCo"},"outputs":[],"source":["train_path=\"/content/drive/MyDrive/face /face_data/train/images\"\n","val_path=\"/content/drive/MyDrive/face /face_data/val/images\"\n","test_path=\"/content/drive/MyDrive/face /face_data/test\""]},{"cell_type":"code","execution_count":4,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2407,"status":"ok","timestamp":1663664517892,"user":{"displayName":"19EC032 Hari haran R","userId":"00578135646265226488"},"user_tz":-330},"id":"b6EmBHj8UuM4","outputId":"7b9a8095-6c6d-4f75-b819-efc3ebc93715"},"outputs":[{"output_type":"stream","name":"stdout","text":["Cloning into 'yolov5'...\n","remote: Enumerating objects: 12583, done.\u001b[K\n","remote: Counting objects: 100% (116/116), done.\u001b[K\n","remote: Compressing objects: 100% (61/61), done.\u001b[K\n","remote: Total 12583 (delta 76), reused 89 (delta 55), pack-reused 12467\u001b[K\n","Receiving objects: 100% (12583/12583), 12.81 MiB | 17.52 MiB/s, done.\n","Resolving deltas: 100% (8670/8670), done.\n"]}],"source":["!git clone https://github.com/ultralytics/yolov5"]},{"cell_type":"code","source":[],"metadata":{"id":"Lm-voiWaWEV0"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"d2awe3y6WGGq"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":5,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":6,"status":"ok","timestamp":1663664517892,"user":{"displayName":"19EC032 Hari haran R","userId":"00578135646265226488"},"user_tz":-330},"id":"7p55R9vOV0Tk","outputId":"da4b7da9-6e99-4716-853d-6f54ec9249e0"},"outputs":[{"output_type":"stream","name":"stdout","text":["/content/yolov5\n"]}],"source":["%cd yolov5/"]},{"cell_type":"code","execution_count":6,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":5338,"status":"ok","timestamp":1663664523226,"user":{"displayName":"19EC032 Hari haran R","userId":"00578135646265226488"},"user_tz":-330},"id":"xs9cn3tVV49g","outputId":"eb0619fd-ddce-40c5-e1d3-8f403055d2aa"},"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Requirement already satisfied: matplotlib>=3.2.2 in /usr/local/lib/python3.7/dist-packages (from -r requirements.txt (line 5)) (3.2.2)\n","Requirement already satisfied: numpy>=1.18.5 in /usr/local/lib/python3.7/dist-packages (from -r requirements.txt (line 6)) (1.21.6)\n","Requirement already satisfied: opencv-python>=4.1.1 in /usr/local/lib/python3.7/dist-packages (from -r requirements.txt (line 7)) (4.6.0.66)\n","Requirement already satisfied: Pillow>=7.1.2 in /usr/local/lib/python3.7/dist-packages (from -r requirements.txt (line 8)) (7.1.2)\n","Requirement already satisfied: PyYAML>=5.3.1 in /usr/local/lib/python3.7/dist-packages (from -r requirements.txt (line 9)) (6.0)\n","Requirement already satisfied: requests>=2.23.0 in /usr/local/lib/python3.7/dist-packages (from -r requirements.txt (line 10)) (2.23.0)\n","Requirement already satisfied: scipy>=1.4.1 in /usr/local/lib/python3.7/dist-packages (from -r requirements.txt (line 11)) (1.7.3)\n","Requirement already satisfied: torch>=1.7.0 in /usr/local/lib/python3.7/dist-packages (from -r requirements.txt (line 12)) (1.12.1+cu113)\n","Requirement already satisfied: torchvision>=0.8.1 in /usr/local/lib/python3.7/dist-packages (from -r requirements.txt (line 13)) (0.13.1+cu113)\n","Requirement already satisfied: tqdm>=4.64.0 in /usr/local/lib/python3.7/dist-packages (from -r requirements.txt (line 14)) (4.64.1)\n","Requirement already satisfied: tensorboard>=2.4.1 in /usr/local/lib/python3.7/dist-packages (from -r requirements.txt (line 18)) (2.8.0)\n","Requirement already satisfied: pandas>=1.1.4 in /usr/local/lib/python3.7/dist-packages (from -r requirements.txt (line 23)) (1.3.5)\n","Requirement already satisfied: seaborn>=0.11.0 in /usr/local/lib/python3.7/dist-packages (from -r requirements.txt (line 24)) (0.11.2)\n","Requirement already satisfied: ipython in /usr/local/lib/python3.7/dist-packages (from -r requirements.txt (line 38)) (7.9.0)\n","Requirement already satisfied: psutil in /usr/local/lib/python3.7/dist-packages (from -r requirements.txt (line 39)) (5.4.8)\n","Collecting thop>=0.1.1\n","  Downloading thop-0.1.1.post2209072238-py3-none-any.whl (15 kB)\n","Requirement already satisfied: kiwisolver>=1.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib>=3.2.2->-r requirements.txt (line 5)) (1.4.4)\n","Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.7/dist-packages (from matplotlib>=3.2.2->-r requirements.txt (line 5)) (0.11.0)\n","Requirement already satisfied: python-dateutil>=2.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib>=3.2.2->-r requirements.txt (line 5)) (2.8.2)\n","Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,>=2.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib>=3.2.2->-r requirements.txt (line 5)) (3.0.9)\n","Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests>=2.23.0->-r requirements.txt (line 10)) (1.24.3)\n","Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.7/dist-packages (from requests>=2.23.0->-r requirements.txt (line 10)) (2.10)\n","Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests>=2.23.0->-r requirements.txt (line 10)) (3.0.4)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests>=2.23.0->-r requirements.txt (line 10)) (2022.6.15)\n","Requirement already satisfied: typing-extensions in /usr/local/lib/python3.7/dist-packages (from torch>=1.7.0->-r requirements.txt (line 12)) (4.1.1)\n","Requirement already satisfied: setuptools>=41.0.0 in /usr/local/lib/python3.7/dist-packages (from tensorboard>=2.4.1->-r requirements.txt (line 18)) (57.4.0)\n","Requirement already satisfied: grpcio>=1.24.3 in /usr/local/lib/python3.7/dist-packages (from tensorboard>=2.4.1->-r requirements.txt (line 18)) (1.48.1)\n","Requirement already satisfied: werkzeug>=0.11.15 in /usr/local/lib/python3.7/dist-packages (from tensorboard>=2.4.1->-r requirements.txt (line 18)) (1.0.1)\n","Requirement already satisfied: absl-py>=0.4 in /usr/local/lib/python3.7/dist-packages (from tensorboard>=2.4.1->-r requirements.txt (line 18)) (1.2.0)\n","Requirement already satisfied: tensorboard-plugin-wit>=1.6.0 in /usr/local/lib/python3.7/dist-packages (from tensorboard>=2.4.1->-r requirements.txt (line 18)) (1.8.1)\n","Requirement already satisfied: tensorboard-data-server<0.7.0,>=0.6.0 in /usr/local/lib/python3.7/dist-packages (from tensorboard>=2.4.1->-r requirements.txt (line 18)) (0.6.1)\n","Requirement already satisfied: protobuf>=3.6.0 in /usr/local/lib/python3.7/dist-packages (from tensorboard>=2.4.1->-r requirements.txt (line 18)) (3.17.3)\n","Requirement already satisfied: wheel>=0.26 in /usr/local/lib/python3.7/dist-packages (from tensorboard>=2.4.1->-r requirements.txt (line 18)) (0.37.1)\n","Requirement already satisfied: google-auth<3,>=1.6.3 in /usr/local/lib/python3.7/dist-packages (from tensorboard>=2.4.1->-r requirements.txt (line 18)) (1.35.0)\n","Requirement already satisfied: google-auth-oauthlib<0.5,>=0.4.1 in /usr/local/lib/python3.7/dist-packages (from tensorboard>=2.4.1->-r requirements.txt (line 18)) (0.4.6)\n","Requirement already satisfied: markdown>=2.6.8 in /usr/local/lib/python3.7/dist-packages (from tensorboard>=2.4.1->-r requirements.txt (line 18)) (3.4.1)\n","Requirement already satisfied: pytz>=2017.3 in /usr/local/lib/python3.7/dist-packages (from pandas>=1.1.4->-r requirements.txt (line 23)) (2022.2.1)\n","Requirement already satisfied: cachetools<5.0,>=2.0.0 in /usr/local/lib/python3.7/dist-packages (from google-auth<3,>=1.6.3->tensorboard>=2.4.1->-r requirements.txt (line 18)) (4.2.4)\n","Requirement already satisfied: rsa<5,>=3.1.4 in /usr/local/lib/python3.7/dist-packages (from google-auth<3,>=1.6.3->tensorboard>=2.4.1->-r requirements.txt (line 18)) (4.9)\n","Requirement already satisfied: pyasn1-modules>=0.2.1 in /usr/local/lib/python3.7/dist-packages (from google-auth<3,>=1.6.3->tensorboard>=2.4.1->-r requirements.txt (line 18)) (0.2.8)\n","Requirement already satisfied: six>=1.9.0 in /usr/local/lib/python3.7/dist-packages (from google-auth<3,>=1.6.3->tensorboard>=2.4.1->-r requirements.txt (line 18)) (1.15.0)\n","Requirement already satisfied: requests-oauthlib>=0.7.0 in /usr/local/lib/python3.7/dist-packages (from google-auth-oauthlib<0.5,>=0.4.1->tensorboard>=2.4.1->-r requirements.txt (line 18)) (1.3.1)\n","Requirement already satisfied: importlib-metadata>=4.4 in /usr/local/lib/python3.7/dist-packages (from markdown>=2.6.8->tensorboard>=2.4.1->-r requirements.txt (line 18)) (4.12.0)\n","Requirement already satisfied: zipp>=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata>=4.4->markdown>=2.6.8->tensorboard>=2.4.1->-r requirements.txt (line 18)) (3.8.1)\n","Requirement already satisfied: pyasn1<0.5.0,>=0.4.6 in /usr/local/lib/python3.7/dist-packages (from pyasn1-modules>=0.2.1->google-auth<3,>=1.6.3->tensorboard>=2.4.1->-r requirements.txt (line 18)) (0.4.8)\n","Requirement already satisfied: oauthlib>=3.0.0 in /usr/local/lib/python3.7/dist-packages (from requests-oauthlib>=0.7.0->google-auth-oauthlib<0.5,>=0.4.1->tensorboard>=2.4.1->-r requirements.txt (line 18)) (3.2.0)\n","Requirement already satisfied: decorator in /usr/local/lib/python3.7/dist-packages (from ipython->-r requirements.txt (line 38)) (4.4.2)\n","Collecting jedi>=0.10\n","  Downloading jedi-0.18.1-py2.py3-none-any.whl (1.6 MB)\n","\u001b[K     |████████████████████████████████| 1.6 MB 39.8 MB/s \n","\u001b[?25hRequirement already satisfied: pexpect in /usr/local/lib/python3.7/dist-packages (from ipython->-r requirements.txt (line 38)) (4.8.0)\n","Requirement already satisfied: prompt-toolkit<2.1.0,>=2.0.0 in /usr/local/lib/python3.7/dist-packages (from ipython->-r requirements.txt (line 38)) (2.0.10)\n","Requirement already satisfied: pickleshare in /usr/local/lib/python3.7/dist-packages (from ipython->-r requirements.txt (line 38)) (0.7.5)\n","Requirement already satisfied: backcall in /usr/local/lib/python3.7/dist-packages (from ipython->-r requirements.txt (line 38)) (0.2.0)\n","Requirement already satisfied: pygments in /usr/local/lib/python3.7/dist-packages (from ipython->-r requirements.txt (line 38)) (2.6.1)\n","Requirement already satisfied: traitlets>=4.2 in /usr/local/lib/python3.7/dist-packages (from ipython->-r requirements.txt (line 38)) (5.1.1)\n","Requirement already satisfied: parso<0.9.0,>=0.8.0 in /usr/local/lib/python3.7/dist-packages (from jedi>=0.10->ipython->-r requirements.txt (line 38)) (0.8.3)\n","Requirement already satisfied: wcwidth in /usr/local/lib/python3.7/dist-packages (from prompt-toolkit<2.1.0,>=2.0.0->ipython->-r requirements.txt (line 38)) (0.2.5)\n","Requirement already satisfied: ptyprocess>=0.5 in /usr/local/lib/python3.7/dist-packages (from pexpect->ipython->-r requirements.txt (line 38)) (0.7.0)\n","Installing collected packages: jedi, thop\n","Successfully installed jedi-0.18.1 thop-0.1.1.post2209072238\n"]}],"source":["!pip install -r requirements.txt"]},{"cell_type":"code","execution_count":7,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":871,"status":"ok","timestamp":1663664524080,"user":{"displayName":"19EC032 Hari haran R","userId":"00578135646265226488"},"user_tz":-330},"id":"2L0HDfWHYr2b","outputId":"9d7ef204-4ace-4f3f-c863-e18affe6514d"},"outputs":[{"output_type":"stream","name":"stdout","text":["--2022-09-20 09:02:04--  https://github.com/ultralytics/yolov5/blob/master/models/yolov5s.yaml\n","Resolving github.com (github.com)... 20.205.243.166\n","Connecting to github.com (github.com)|20.205.243.166|:443... connected.\n","HTTP request sent, awaiting response... 200 OK\n","Length: unspecified [text/html]\n","Saving to: ‘yolov5s.yaml’\n","\n","yolov5s.yaml            [ <=>                ] 166.30K  --.-KB/s    in 0.01s   \n","\n","2022-09-20 09:02:04 (13.6 MB/s) - ‘yolov5s.yaml’ saved [170289]\n","\n"]}],"source":["!wget https://github.com/ultralytics/yolov5/blob/master/models/yolov5s.yaml"]},{"cell_type":"code","execution_count":8,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"xYCgRGKrZp-6","executionInfo":{"status":"ok","timestamp":1663665701557,"user_tz":-330,"elapsed":1177479,"user":{"displayName":"19EC032 Hari haran R","userId":"00578135646265226488"}},"outputId":"7ec96ba2-7261-44ea-954b-4820926022f0"},"outputs":[{"output_type":"stream","name":"stdout","text":["\u001b[34m\u001b[1mtrain: \u001b[0mweights=/content/yolov5/yolov5s.pt, cfg=, data=/content/drive/MyDrive/face /dataSet.yaml, hyp=data/hyps/hyp.scratch-low.yaml, epochs=50, batch_size=16, imgsz=640, rect=False, resume=False, nosave=True, noval=False, noautoanchor=False, noplots=False, evolve=None, bucket=, cache=ram, image_weights=False, device=, multi_scale=False, single_cls=False, optimizer=SGD, sync_bn=False, workers=8, project=runs/train, name=exp, exist_ok=False, quad=False, cos_lr=False, label_smoothing=0.0, patience=100, freeze=[0], save_period=-1, seed=0, local_rank=-1, entity=None, upload_dataset=False, bbox_interval=-1, artifact_alias=latest\n","\u001b[34m\u001b[1mgithub: \u001b[0mup to date with https://github.com/ultralytics/yolov5 ✅\n","YOLOv5 🚀 v6.2-143-g63368e7 Python-3.7.14 torch-1.12.1+cu113 CUDA:0 (Tesla T4, 15110MiB)\n","\n","\u001b[34m\u001b[1mhyperparameters: \u001b[0mlr0=0.01, lrf=0.01, momentum=0.937, weight_decay=0.0005, warmup_epochs=3.0, warmup_momentum=0.8, warmup_bias_lr=0.1, box=0.05, cls=0.5, cls_pw=1.0, obj=1.0, obj_pw=1.0, iou_t=0.2, anchor_t=4.0, fl_gamma=0.0, hsv_h=0.015, hsv_s=0.7, hsv_v=0.4, degrees=0.0, translate=0.1, scale=0.5, shear=0.0, perspective=0.0, flipud=0.0, fliplr=0.5, mosaic=1.0, mixup=0.0, copy_paste=0.0\n","\u001b[34m\u001b[1mWeights & Biases: \u001b[0mrun 'pip install wandb' to automatically track and visualize YOLOv5 🚀 runs in Weights & Biases\n","\u001b[34m\u001b[1mClearML: \u001b[0mrun 'pip install clearml' to automatically track, visualize and remotely train YOLOv5 🚀 in ClearML\n","\u001b[34m\u001b[1mComet: \u001b[0mrun 'pip install comet_ml' to automatically track and visualize YOLOv5 🚀 runs in Comet\n","\u001b[34m\u001b[1mTensorBoard: \u001b[0mStart with 'tensorboard --logdir runs/train', view at http://localhost:6006/\n","Downloading https://ultralytics.com/assets/Arial.ttf to /root/.config/Ultralytics/Arial.ttf...\n","100% 755k/755k [00:00<00:00, 139MB/s]\n","Downloading https://github.com/ultralytics/yolov5/releases/download/v6.2/yolov5s.pt to /content/yolov5/yolov5s.pt...\n","100% 14.1M/14.1M [00:00<00:00, 310MB/s]\n","\n","Overriding model.yaml nc=80 with nc=2\n","\n","                 from  n    params  module                                  arguments                     \n","  0                -1  1      3520  models.common.Conv                      [3, 32, 6, 2, 2]              \n","  1                -1  1     18560  models.common.Conv                      [32, 64, 3, 2]                \n","  2                -1  1     18816  models.common.C3                        [64, 64, 1]                   \n","  3                -1  1     73984  models.common.Conv                      [64, 128, 3, 2]               \n","  4                -1  2    115712  models.common.C3                        [128, 128, 2]                 \n","  5                -1  1    295424  models.common.Conv                      [128, 256, 3, 2]              \n","  6                -1  3    625152  models.common.C3                        [256, 256, 3]                 \n","  7                -1  1   1180672  models.common.Conv                      [256, 512, 3, 2]              \n","  8                -1  1   1182720  models.common.C3                        [512, 512, 1]                 \n","  9                -1  1    656896  models.common.SPPF                      [512, 512, 5]                 \n"," 10                -1  1    131584  models.common.Conv                      [512, 256, 1, 1]              \n"," 11                -1  1         0  torch.nn.modules.upsampling.Upsample    [None, 2, 'nearest']          \n"," 12           [-1, 6]  1         0  models.common.Concat                    [1]                           \n"," 13                -1  1    361984  models.common.C3                        [512, 256, 1, False]          \n"," 14                -1  1     33024  models.common.Conv                      [256, 128, 1, 1]              \n"," 15                -1  1         0  torch.nn.modules.upsampling.Upsample    [None, 2, 'nearest']          \n"," 16           [-1, 4]  1         0  models.common.Concat                    [1]                           \n"," 17                -1  1     90880  models.common.C3                        [256, 128, 1, False]          \n"," 18                -1  1    147712  models.common.Conv                      [128, 128, 3, 2]              \n"," 19          [-1, 14]  1         0  models.common.Concat                    [1]                           \n"," 20                -1  1    296448  models.common.C3                        [256, 256, 1, False]          \n"," 21                -1  1    590336  models.common.Conv                      [256, 256, 3, 2]              \n"," 22          [-1, 10]  1         0  models.common.Concat                    [1]                           \n"," 23                -1  1   1182720  models.common.C3                        [512, 512, 1, False]          \n"," 24      [17, 20, 23]  1     18879  models.yolo.Detect                      [2, [[10, 13, 16, 30, 33, 23], [30, 61, 62, 45, 59, 119], [116, 90, 156, 198, 373, 326]], [128, 256, 512]]\n","Model summary: 214 layers, 7025023 parameters, 7025023 gradients, 16.0 GFLOPs\n","\n","Transferred 343/349 items from /content/yolov5/yolov5s.pt\n","\u001b[34m\u001b[1mAMP: \u001b[0mchecks passed ✅\n","\u001b[34m\u001b[1moptimizer:\u001b[0m SGD(lr=0.01) with parameter groups 57 weight(decay=0.0), 60 weight(decay=0.0005), 60 bias\n","\u001b[34m\u001b[1malbumentations: \u001b[0mBlur(p=0.01, blur_limit=(3, 7)), MedianBlur(p=0.01, blur_limit=(3, 7)), ToGray(p=0.01), CLAHE(p=0.01, clip_limit=(1, 4.0), tile_grid_size=(8, 8))\n","\u001b[34m\u001b[1mtrain: \u001b[0mScanning '/content/drive/MyDrive/face /face_data/train/labels.cache' images and labels... 1161 found, 0 missing, 0 empty, 0 corrupt: 100% 1161/1161 [00:00<?, ?it/s]\n","\u001b[34m\u001b[1mtrain: \u001b[0mCaching images (0.5GB ram):  54% 625/1161 [00:32<00:07, 72.51it/s]libpng warning: iCCP: Not recognizing known sRGB profile that has been edited\n","\u001b[34m\u001b[1mtrain: \u001b[0mCaching images (1.0GB ram): 100% 1161/1161 [00:57<00:00, 20.28it/s]\n","\u001b[34m\u001b[1mval: \u001b[0mScanning '/content/drive/MyDrive/face /face_data/val/labels.cache' images and labels... 290 found, 0 missing, 0 empty, 0 corrupt: 100% 290/290 [00:00<?, ?it/s]\n","\u001b[34m\u001b[1mval: \u001b[0mCaching images (0.2GB ram): 100% 290/290 [00:16<00:00, 17.36it/s]\n","\n","\u001b[34m\u001b[1mAutoAnchor: \u001b[0m5.58 anchors/target, 0.999 Best Possible Recall (BPR). Current anchors are a good fit to dataset ✅\n","Plotting labels to runs/train/exp/labels.jpg... \n","Image sizes 640 train, 640 val\n","Using 2 dataloader workers\n","Logging results to \u001b[1mruns/train/exp\u001b[0m\n","Starting training for 50 epochs...\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","       0/49      3.73G     0.1004    0.05512    0.02507         54        640: 100% 73/73 [00:24<00:00,  2.93it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:04<00:00,  2.30it/s]\n","                   all        290       1079      0.605      0.155     0.0858     0.0211\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","       1/49      5.35G    0.07289    0.04364    0.01987         41        640: 100% 73/73 [00:18<00:00,  3.94it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  3.98it/s]\n","                   all        290       1079      0.661      0.287      0.174     0.0474\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","       2/49      5.35G    0.06806    0.03878    0.01861         31        640: 100% 73/73 [00:18<00:00,  3.95it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.21it/s]\n","                   all        290       1079      0.295      0.533      0.409       0.13\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","       3/49      5.35G    0.06041    0.03733    0.01343         35        640: 100% 73/73 [00:18<00:00,  3.88it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.35it/s]\n","                   all        290       1079      0.496      0.643      0.573      0.212\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","       4/49      5.35G    0.05355    0.03535   0.008644         51        640: 100% 73/73 [00:18<00:00,  3.88it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.41it/s]\n","                   all        290       1079      0.677      0.713      0.708       0.33\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","       5/49      5.35G    0.04824    0.03337   0.006579         53        640: 100% 73/73 [00:18<00:00,  3.95it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.25it/s]\n","                   all        290       1079      0.749      0.706      0.769       0.34\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","       6/49      5.35G    0.04527    0.03368   0.005793         72        640: 100% 73/73 [00:18<00:00,  3.91it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.39it/s]\n","                   all        290       1079      0.819      0.769      0.824      0.385\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","       7/49      5.35G    0.04402    0.03375   0.005016         84        640: 100% 73/73 [00:18<00:00,  3.88it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.47it/s]\n","                   all        290       1079      0.865      0.801      0.859      0.394\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","       8/49      5.35G    0.04199    0.03268   0.004948         62        640: 100% 73/73 [00:20<00:00,  3.64it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.46it/s]\n","                   all        290       1079       0.87      0.781      0.841      0.424\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","       9/49      5.35G    0.04097    0.03238   0.004188         55        640: 100% 73/73 [00:18<00:00,  4.02it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.50it/s]\n","                   all        290       1079      0.848       0.83      0.865      0.416\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      10/49      5.35G    0.03945    0.03227   0.004023         64        640: 100% 73/73 [00:18<00:00,  3.98it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.50it/s]\n","                   all        290       1079      0.862      0.811      0.872      0.439\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      11/49      5.35G    0.03768    0.03245   0.003331         60        640: 100% 73/73 [00:18<00:00,  3.98it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.48it/s]\n","                   all        290       1079      0.848      0.798      0.844      0.445\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      12/49      5.35G    0.03809    0.03171    0.00357         68        640: 100% 73/73 [00:18<00:00,  3.99it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.51it/s]\n","                   all        290       1079      0.874      0.767      0.852       0.43\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      13/49      5.35G    0.03666     0.0298   0.003401         59        640: 100% 73/73 [00:18<00:00,  4.00it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.61it/s]\n","                   all        290       1079      0.853      0.796      0.837       0.43\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      14/49      5.35G    0.03656    0.03031   0.002959         56        640: 100% 73/73 [00:18<00:00,  4.02it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.50it/s]\n","                   all        290       1079      0.869      0.783      0.827      0.429\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      15/49      5.35G    0.03423    0.03003    0.00297         55        640: 100% 73/73 [00:18<00:00,  4.00it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.58it/s]\n","                   all        290       1079       0.89      0.785      0.841       0.46\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      16/49      5.35G    0.03538    0.03059   0.002845         73        640: 100% 73/73 [00:18<00:00,  3.97it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.60it/s]\n","                   all        290       1079      0.897      0.795      0.857      0.458\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      17/49      5.35G     0.0348    0.02975   0.002529         28        640: 100% 73/73 [00:19<00:00,  3.68it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.48it/s]\n","                   all        290       1079      0.885      0.799      0.866      0.445\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      18/49      5.35G    0.03378    0.03134   0.002827         90        640: 100% 73/73 [00:18<00:00,  4.02it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.49it/s]\n","                   all        290       1079      0.868      0.808      0.847      0.448\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      19/49      5.35G    0.03332    0.02967   0.002495         40        640: 100% 73/73 [00:18<00:00,  3.96it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.54it/s]\n","                   all        290       1079      0.904      0.813      0.868      0.473\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      20/49      5.35G    0.03296    0.02895   0.002297        109        640: 100% 73/73 [00:18<00:00,  3.99it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.48it/s]\n","                   all        290       1079      0.889      0.803       0.86      0.447\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      21/49      5.35G    0.03255    0.02977    0.00223         72        640: 100% 73/73 [00:18<00:00,  3.96it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.53it/s]\n","                   all        290       1079      0.865      0.802      0.839      0.443\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      22/49      5.35G    0.03228    0.02928   0.002321         92        640: 100% 73/73 [00:18<00:00,  4.00it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.41it/s]\n","                   all        290       1079      0.887      0.808      0.871      0.467\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      23/49      5.35G    0.03132    0.02806   0.002313         77        640: 100% 73/73 [00:18<00:00,  4.02it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.57it/s]\n","                   all        290       1079      0.879      0.809      0.848      0.463\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      24/49      5.35G    0.03062     0.0281   0.002198        161        640: 100% 73/73 [00:18<00:00,  4.02it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.59it/s]\n","                   all        290       1079      0.898      0.815      0.878      0.481\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      25/49      5.35G    0.03071    0.02706   0.001959         63        640: 100% 73/73 [00:18<00:00,  4.05it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.63it/s]\n","                   all        290       1079       0.85      0.831      0.855      0.428\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      26/49      5.35G    0.03002    0.02804   0.001847         53        640: 100% 73/73 [00:19<00:00,  3.69it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.63it/s]\n","                   all        290       1079      0.906      0.828       0.89      0.485\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      27/49      5.35G     0.0298    0.02767   0.001756         92        640: 100% 73/73 [00:18<00:00,  4.00it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.52it/s]\n","                   all        290       1079      0.908      0.823       0.87      0.485\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      28/49      5.35G    0.02929    0.02708   0.001819         66        640: 100% 73/73 [00:18<00:00,  4.01it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.67it/s]\n","                   all        290       1079      0.908      0.837      0.895      0.505\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      29/49      5.35G     0.0291    0.02786   0.001684         55        640: 100% 73/73 [00:18<00:00,  3.99it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.68it/s]\n","                   all        290       1079      0.917      0.793      0.872      0.478\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      30/49      5.35G    0.02888    0.02648   0.001499         74        640: 100% 73/73 [00:18<00:00,  4.05it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.58it/s]\n","                   all        290       1079      0.902      0.809      0.879      0.494\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      31/49      5.35G    0.02885    0.02779   0.001766         66        640: 100% 73/73 [00:18<00:00,  3.98it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.53it/s]\n","                   all        290       1079      0.896       0.82      0.871      0.498\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      32/49      5.35G    0.02752    0.02603   0.001654         69        640: 100% 73/73 [00:18<00:00,  3.99it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.59it/s]\n","                   all        290       1079      0.904       0.81      0.873      0.495\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      33/49      5.35G    0.02803    0.02714   0.001538         97        640: 100% 73/73 [00:18<00:00,  4.04it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.44it/s]\n","                   all        290       1079      0.891      0.805      0.868      0.495\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      34/49      5.35G    0.02772    0.02643   0.001458         82        640: 100% 73/73 [00:18<00:00,  3.96it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.60it/s]\n","                   all        290       1079      0.893      0.811       0.86      0.485\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      35/49      5.35G    0.02734    0.02528   0.001461         48        640: 100% 73/73 [00:19<00:00,  3.70it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.63it/s]\n","                   all        290       1079      0.909      0.818      0.875      0.507\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      36/49      5.35G    0.02695    0.02647    0.00136         44        640: 100% 73/73 [00:18<00:00,  3.99it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.65it/s]\n","                   all        290       1079      0.889      0.811      0.862      0.487\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      37/49      5.35G    0.02669    0.02532   0.001263         32        640: 100% 73/73 [00:18<00:00,  4.02it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.60it/s]\n","                   all        290       1079      0.932      0.811      0.887      0.497\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      38/49      5.35G    0.02606    0.02475   0.001261         63        640: 100% 73/73 [00:18<00:00,  4.00it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.65it/s]\n","                   all        290       1079      0.902       0.82      0.879        0.5\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      39/49      5.35G    0.02627    0.02493   0.001216         90        640: 100% 73/73 [00:18<00:00,  4.03it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.56it/s]\n","                   all        290       1079      0.908      0.823      0.871      0.491\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      40/49      5.35G      0.026    0.02505   0.001193         66        640: 100% 73/73 [00:18<00:00,  3.99it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.71it/s]\n","                   all        290       1079      0.897      0.826      0.873       0.51\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      41/49      5.35G    0.02567    0.02524    0.00126         49        640: 100% 73/73 [00:18<00:00,  3.96it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.55it/s]\n","                   all        290       1079      0.898       0.84      0.873      0.503\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      42/49      5.35G    0.02562    0.02566   0.001238         61        640: 100% 73/73 [00:18<00:00,  3.97it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.46it/s]\n","                   all        290       1079      0.875      0.846      0.882      0.508\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      43/49      5.35G    0.02489    0.02381   0.001109         40        640: 100% 73/73 [00:18<00:00,  3.96it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:03<00:00,  3.04it/s]\n","                   all        290       1079      0.907      0.823      0.877      0.508\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      44/49      5.35G    0.02564    0.02474   0.001119         74        640: 100% 73/73 [00:18<00:00,  3.93it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.63it/s]\n","                   all        290       1079      0.902      0.837      0.881      0.506\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      45/49      5.35G    0.02482    0.02369   0.001126         46        640: 100% 73/73 [00:18<00:00,  4.04it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.39it/s]\n","                   all        290       1079      0.903      0.828      0.874      0.503\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      46/49      5.35G    0.02473    0.02468  0.0009291         54        640: 100% 73/73 [00:18<00:00,  3.98it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.56it/s]\n","                   all        290       1079      0.895      0.831      0.877      0.511\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      47/49      5.35G     0.0243    0.02293  0.0009798         58        640: 100% 73/73 [00:17<00:00,  4.06it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.57it/s]\n","                   all        290       1079       0.91      0.826      0.876      0.507\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      48/49      5.35G    0.02423    0.02419   0.001163         51        640: 100% 73/73 [00:18<00:00,  4.01it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.68it/s]\n","                   all        290       1079      0.895      0.833       0.88      0.513\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      49/49      5.35G    0.02435    0.02456  0.0009944         58        640: 100% 73/73 [00:18<00:00,  4.01it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:02<00:00,  4.64it/s]\n","                   all        290       1079      0.893      0.831      0.882      0.514\n","\n","50 epochs completed in 0.290 hours.\n","Optimizer stripped from runs/train/exp/weights/last.pt, 14.4MB\n","Optimizer stripped from runs/train/exp/weights/best.pt, 14.4MB\n","\n","Validating runs/train/exp/weights/best.pt...\n","Fusing layers... \n","Model summary: 157 layers, 7015519 parameters, 0 gradients, 15.8 GFLOPs\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 10/10 [00:03<00:00,  2.50it/s]\n","                   all        290       1079      0.893      0.831      0.881      0.514\n","                  mask        290        822      0.939      0.891      0.947      0.589\n","                nomask        290        257      0.846      0.771      0.815      0.439\n","Results saved to \u001b[1mruns/train/exp\u001b[0m\n"]}],"source":["!python train.py --img 640 --batch 16 --epochs 50 --data \"/content/drive/MyDrive/face /dataSet.yaml\" --weights \"/content/yolov5/yolov5s.pt\" --nosave --cache"]},{"cell_type":"markdown","metadata":{"id":"fbPySNmEvR80"},"source":[]},{"cell_type":"code","source":["!python detect.py --weights \"/content/yolov5/runs/train/exp/weights/last.pt\" --img 640 --conf 0.25 --source \"/content/drive/MyDrive/face /face_data/test\""],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"_QChH9D2NFI_","executionInfo":{"status":"ok","timestamp":1663666070241,"user_tz":-330,"elapsed":29749,"user":{"displayName":"19EC032 Hari haran R","userId":"00578135646265226488"}},"outputId":"c8c5bd86-701c-4920-a52b-8e5c15d49554"},"execution_count":10,"outputs":[{"output_type":"stream","name":"stdout","text":["\u001b[34m\u001b[1mdetect: \u001b[0mweights=['/content/yolov5/runs/train/exp/weights/last.pt'], source=/content/drive/MyDrive/face /face_data/test, data=data/coco128.yaml, imgsz=[640, 640], conf_thres=0.25, iou_thres=0.45, max_det=1000, device=, view_img=False, save_txt=False, save_conf=False, save_crop=False, nosave=False, classes=None, agnostic_nms=False, augment=False, visualize=False, update=False, project=runs/detect, name=exp, exist_ok=False, line_thickness=3, hide_labels=False, hide_conf=False, half=False, dnn=False, vid_stride=1\n","YOLOv5 🚀 v6.2-143-g63368e7 Python-3.7.14 torch-1.12.1+cu113 CUDA:0 (Tesla T4, 15110MiB)\n","\n","Fusing layers... \n","Model summary: 157 layers, 7015519 parameters, 0 gradients, 15.8 GFLOPs\n","image 1/15 /content/drive/MyDrive/face /face_data/test/173.jpg: 640x640 1 nomask, 12.9ms\n","image 2/15 /content/drive/MyDrive/face /face_data/test/27.jpg: 640x640 1 nomask, 12.9ms\n","image 3/15 /content/drive/MyDrive/face /face_data/test/crowd_mask181.jpg: 384x640 12 masks, 13.9ms\n","image 4/15 /content/drive/MyDrive/face /face_data/test/crowd_mask23.jpg: 352x640 1 mask, 14.3ms\n","image 5/15 /content/drive/MyDrive/face /face_data/test/crowd_mask38.jpg: 416x640 1 mask, 13.5ms\n","image 6/15 /content/drive/MyDrive/face /face_data/test/crowd_mask62.jpg: 480x640 4 masks, 4 nomasks, 12.7ms\n","image 7/15 /content/drive/MyDrive/face /face_data/test/crowd_mask65.jpg: 384x640 10 masks, 1 nomask, 9.5ms\n","image 8/15 /content/drive/MyDrive/face /face_data/test/image_117.jpg: 416x640 1 mask, 10.0ms\n","image 9/15 /content/drive/MyDrive/face /face_data/test/image_5.jpg: 480x640 1 mask, 14.3ms\n","image 10/15 /content/drive/MyDrive/face /face_data/test/image_503.jpg: 448x640 1 mask, 13.2ms\n","image 11/15 /content/drive/MyDrive/face /face_data/test/image_577.jpeg: 640x448 5 masks, 14.1ms\n","image 12/15 /content/drive/MyDrive/face /face_data/test/image_602.jpg: 640x448 1 nomask, 9.7ms\n","image 13/15 /content/drive/MyDrive/face /face_data/test/image_605.jpg: 640x448 1 mask, 9.7ms\n","image 14/15 /content/drive/MyDrive/face /face_data/test/image_609.jpg: 640x448 1 nomask, 9.7ms\n","image 15/15 /content/drive/MyDrive/face /face_data/test/new_116.jpg: 640x640 1 nomask, 12.9ms\n","Speed: 0.6ms pre-process, 12.2ms inference, 1.1ms NMS per image at shape (1, 3, 640, 640)\n","Results saved to \u001b[1mruns/detect/exp2\u001b[0m\n"]}]},{"cell_type":"code","source":["#display images\n","import glob\n","from IPython.display import Image, display\n","for imagename in glob.glob(\"/content/yolov5/runs/detect/exp2/*.jpg\"):\n","  display(Image(filename=imagename))\n","  print(\"/n\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000,"output_embedded_package_id":"1X4x0w2RLUN-gcpy_BO0N-X4tEyCOPdIQ"},"id":"nBGHwnnxOete","executionInfo":{"status":"ok","timestamp":1663666707706,"user_tz":-330,"elapsed":12123,"user":{"displayName":"19EC032 Hari haran R","userId":"00578135646265226488"}},"outputId":"e303cf86-b02d-47d0-e57a-e7930f518f48"},"execution_count":13,"outputs":[{"output_type":"display_data","data":{"text/plain":"Output hidden; open in https://colab.research.google.com to view."},"metadata":{}}]},{"cell_type":"code","source":["from google.colab import files\n","files.download(\"/content/yolov5\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":34},"id":"CNRAuCKbWJXw","executionInfo":{"status":"ok","timestamp":1663668268281,"user_tz":-330,"elapsed":903,"user":{"displayName":"19EC032 Hari haran R","userId":"00578135646265226488"}},"outputId":"f2fcadc5-5c9d-43de-fcd9-cd3077ef8edc"},"execution_count":14,"outputs":[{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.Javascript object>"],"application/javascript":["\n","    async function download(id, filename, size) {\n","      if (!google.colab.kernel.accessAllowed) {\n","        return;\n","      }\n","      const div = document.createElement('div');\n","      const label = document.createElement('label');\n","      label.textContent = `Downloading \"${filename}\": `;\n","      div.appendChild(label);\n","      const progress = document.createElement('progress');\n","      progress.max = size;\n","      div.appendChild(progress);\n","      document.body.appendChild(div);\n","\n","      const buffers = [];\n","      let downloaded = 0;\n","\n","      const channel = await google.colab.kernel.comms.open(id);\n","      // Send a message to notify the kernel that we're ready.\n","      channel.send({})\n","\n","      for await (const message of channel.messages) {\n","        // Send a message to notify the kernel that we're ready.\n","        channel.send({})\n","        if (message.buffers) {\n","          for (const buffer of message.buffers) {\n","            buffers.push(buffer);\n","            downloaded += buffer.byteLength;\n","            progress.value = downloaded;\n","          }\n","        }\n","      }\n","      const blob = new Blob(buffers, {type: 'application/binary'});\n","      const a = document.createElement('a');\n","      a.href = window.URL.createObjectURL(blob);\n","      a.download = filename;\n","      div.appendChild(a);\n","      a.click();\n","      div.remove();\n","    }\n","  "]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.Javascript object>"],"application/javascript":["download(\"download_3f47c904-bb6a-4b82-9c2e-8a07aa0d074a\", \"yolov5\", 4096)"]},"metadata":{}}]}],"metadata":{"accelerator":"GPU","colab":{"collapsed_sections":[],"provenance":[],"mount_file_id":"1bHOcbNe88-ZAClPqq5VxJZX1uIsIBMbN","authorship_tag":"ABX9TyOxhodt3RiGRw0sMXjDDhe0"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}